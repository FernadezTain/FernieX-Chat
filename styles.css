/* ═══════════════════════════════════════════════════════
   NEXCHAT — AURORA DREAM THEME
   Soft luminous glassmorphism · silk animations · aurora glow
═══════════════════════════════════════════════════════ */

/* ─── RESET ─── */
*, *::before, *::after {
  margin: 0; padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

/* ─── VARIABLES ─── */
:root {
  --bg:  #05060f;
  --bg2: #080b18;
  --bg3: #0b0f20;
  --s1: rgba(255,255,255,.035);
  --s2: rgba(255,255,255,.065);
  --s3: rgba(255,255,255,.10);
  --b1: rgba(255,255,255,.06);
  --b2: rgba(255,255,255,.11);
  --b3: rgba(255,255,255,.18);
  --rose:   #f472b6;
  --violet: #a78bfa;
  --sky:    #38bdf8;
  --mint:   #34d399;
  --amber:  #fbbf24;
  --coral:  #fb7185;
  --t1: #f0f4ff;
  --t2: #9ba8cc;
  --t3: #3d4d70;
  --t4: #252f4a;
  --danger: #f87171;
  --green:  #4ade80;
  --font: 'Outfit', sans-serif;
}

@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap');

html, body {
  height: 100%;
  background: var(--bg);
  font-family: var(--font);
  color: var(--t1);
  overflow: hidden;
}
input, textarea, button { font-family: var(--font); }

/* ─── AURORA BG ─── */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background:
    radial-gradient(ellipse 120% 80% at 10% -10%, rgba(139,92,246,.18) 0%, transparent 50%),
    radial-gradient(ellipse 80% 60% at 90% 110%,  rgba(56,189,248,.15) 0%, transparent 50%),
    radial-gradient(ellipse 60% 50% at 50% 50%,   rgba(244,114,182,.08) 0%, transparent 60%),
    radial-gradient(ellipse 40% 40% at 80% 20%,   rgba(52,211,153,.1) 0%, transparent 50%);
  animation: auroraShift 20s ease-in-out infinite alternate;
}
@keyframes auroraShift {
  0%   { filter: hue-rotate(0deg)   brightness(1); }
  33%  { filter: hue-rotate(15deg)  brightness(1.05); }
  66%  { filter: hue-rotate(-10deg) brightness(.98); }
  100% { filter: hue-rotate(25deg)  brightness(1.08); }
}

/* ─── SCREENS ─── */
.screen {
  position: fixed; inset: 0;
  display: flex; flex-direction: column;
  z-index: 1;
  transition: transform .5s cubic-bezier(.34,1.2,.64,1), opacity .4s ease;
}
.screen.hidden {
  transform: translateX(110%) scale(.96);
  opacity: 0; pointer-events: none; z-index: 0;
}

/* ═══════════════════════════════════════
   AUTH SCREEN
═══════════════════════════════════════ */
#auth-screen {
  background: var(--bg);
  align-items: center; justify-content: center;
  padding: 24px; overflow-y: auto;
}
.auth-wrap {
  width: 100%; max-width: 400px;
  animation: authReveal .7s cubic-bezier(.34,1.2,.64,1) both;
}
@keyframes authReveal {
  from { opacity:0; transform: translateY(40px) scale(.96); }
  to   { opacity:1; transform: none; }
}

/* Logo */
.auth-logo { text-align: center; margin-bottom: 40px; }
.logo-shape { width: 88px; height: 88px; margin: 0 auto 20px; position: relative; }
.logo-spin-ring {
  position: absolute; inset: -4px; border-radius: 28px;
  background: conic-gradient(from 0deg, #f472b6, #a78bfa, #38bdf8, #34d399, #f472b6);
  animation: ringRotate 3s linear infinite; filter: blur(1px);
}
@keyframes ringRotate { to { transform: rotate(360deg); } }
.logo-box {
  position: relative; z-index: 1;
  width: 88px; height: 88px;
  background: linear-gradient(135deg, #1e1040, #0f172a);
  border-radius: 26px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 0 0 1px rgba(255,255,255,.08), 0 20px 60px rgba(139,92,246,.4), inset 0 1px 0 rgba(255,255,255,.1);
  animation: logoBreath 4s ease-in-out infinite;
}
@keyframes logoBreath {
  0%,100% { box-shadow: 0 0 0 1px rgba(255,255,255,.08), 0 20px 60px rgba(139,92,246,.4), inset 0 1px 0 rgba(255,255,255,.1); }
  50%     { box-shadow: 0 0 0 1px rgba(255,255,255,.12), 0 20px 80px rgba(167,139,250,.6), 0 0 40px rgba(244,114,182,.3), inset 0 1px 0 rgba(255,255,255,.15); }
}
.logo-bubble { position: relative; width: 44px; height: 34px; }
.logo-bubble::before {
  content: '';
  position: absolute; width: 44px; height: 32px;
  background: linear-gradient(135deg, #fff, rgba(255,255,255,.9));
  border-radius: 10px 10px 10px 2px; top: 0; left: 0;
  filter: drop-shadow(0 2px 8px rgba(167,139,250,.5));
}
.logo-bubble::after {
  content: ''; position: absolute;
  width: 0; height: 0;
  border-top: 9px solid #fff; border-right: 9px solid transparent;
  bottom: 0; left: 0;
}
.logo-bubble-dots { position: absolute; top: 11px; left: 9px; display: flex; gap: 6px; z-index: 1; }
.logo-bubble-dots span { width: 6px; height: 6px; border-radius: 50%; animation: dotPulse 1.4s ease-in-out infinite; }
.logo-bubble-dots span:nth-child(1) { background: #a78bfa; animation-delay: 0s; }
.logo-bubble-dots span:nth-child(2) { background: #f472b6; animation-delay: .2s; }
.logo-bubble-dots span:nth-child(3) { background: #38bdf8; animation-delay: .4s; }
@keyframes dotPulse {
  0%,100% { transform: scale(1); opacity:.6; }
  50%     { transform: scale(1.35); opacity:1; }
}

.auth-logo h1 {
  font-size: 34px; font-weight: 800; letter-spacing: -1.5px;
  background: linear-gradient(120deg, #f0f4ff, #c4b5fd 40%, #f472b6 70%, #38bdf8);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  background-size: 300%; animation: shimmerText 5s linear infinite;
}
@keyframes shimmerText { 0%{ background-position:0% 50%; } 100%{ background-position:300% 50%; } }
.auth-logo p { color: var(--t3); font-size: 13px; margin-top: 6px; letter-spacing: 1.2px; text-transform: uppercase; font-weight: 500; }

.tab-row {
  display: flex; background: var(--s1); border: 1px solid var(--b1);
  border-radius: 18px; padding: 5px; margin-bottom: 24px; gap: 4px;
  backdrop-filter: blur(20px);
}
.tab-btn {
  flex: 1; padding: 12px; border: none; background: transparent;
  color: var(--t3); font-size: 13px; font-weight: 600;
  border-radius: 13px; cursor: pointer;
  transition: all .3s cubic-bezier(.34,1.2,.64,1);
}
.tab-btn.active {
  background: linear-gradient(135deg, rgba(139,92,246,.8), rgba(99,102,241,.9));
  color: #fff; box-shadow: 0 4px 20px rgba(139,92,246,.4), 0 0 0 1px rgba(255,255,255,.1);
  transform: scale(1.02);
}

.form-group { margin-bottom: 16px; }
.form-label { font-size: 11px; font-weight: 600; color: var(--t3); text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 8px; display: block; }
.form-input {
  width: 100%; background: var(--s1); border: 1px solid var(--b1);
  border-radius: 16px; padding: 14px 18px;
  color: var(--t1); font-size: 15px; outline: none; -webkit-appearance: none;
  transition: all .3s ease; backdrop-filter: blur(16px);
}
.form-input:focus {
  border-color: rgba(167,139,250,.5); background: var(--s2);
  box-shadow: 0 0 0 3px rgba(167,139,250,.12), 0 0 20px rgba(167,139,250,.1);
  transform: translateY(-1px);
}
.form-input::placeholder { color: var(--t4); }
.input-wrap { position: relative; }
.input-eye {
  position: absolute; right: 14px; top: 50%; transform: translateY(-50%);
  cursor: pointer; color: var(--t3); transition: color .2s, transform .2s;
  display: flex; align-items: center;
}
.input-eye:hover { color: var(--violet); transform: translateY(-50%) scale(1.1); }

.auth-btn {
  width: 100%; background: linear-gradient(135deg, #7c3aed, #4f46e5, #2563eb);
  border: none; border-radius: 16px; padding: 16px; color: #fff;
  font-size: 15px; font-weight: 700; cursor: pointer; margin-top: 10px;
  letter-spacing: .4px; position: relative; overflow: hidden;
  box-shadow: 0 8px 30px rgba(124,58,237,.45), inset 0 1px 0 rgba(255,255,255,.12);
  transition: all .3s cubic-bezier(.34,1.2,.64,1);
}
.auth-btn::before {
  content: ''; position: absolute; top: 0; left: -100%;
  width: 100%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.15), transparent);
  transition: left .5s;
}
.auth-btn:hover::before { left: 100%; }
.auth-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 40px rgba(124,58,237,.55); }
.auth-btn:active { transform: scale(.98) translateY(0); }

.auth-error {
  background: rgba(248,113,113,.1); border: 1px solid rgba(248,113,113,.25);
  border-radius: 14px; padding: 12px 16px; color: #fca5a5;
  font-size: 13px; margin-bottom: 16px; display: none; animation: errorShake .4s ease;
}
.auth-error.show { display: block; }
@keyframes errorShake {
  0%,100%{ transform:translateX(0); } 20%{ transform:translateX(-6px); }
  40%{ transform:translateX(6px); } 60%{ transform:translateX(-4px); } 80%{ transform:translateX(4px); }
}

/* ─── ICON SYSTEM ─── */
.ic{display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;position:relative;}
.ic-chat{width:22px;height:22px}.ic-chat::before{content:'';position:absolute;width:18px;height:14px;background:currentColor;border-radius:5px 5px 5px 1px;top:2px;left:2px;}.ic-chat::after{content:'';position:absolute;width:5px;height:5px;background:currentColor;clip-path:polygon(0 0,100% 0,0 100%);bottom:2px;left:4px;}
.ic-edit{width:18px;height:18px}.ic-edit::before{content:'';position:absolute;width:12px;height:12px;border:2px solid currentColor;border-radius:2px;transform:rotate(45deg);top:1px;left:3px;}.ic-edit::after{content:'';position:absolute;width:5px;height:2px;background:currentColor;bottom:2px;right:1px;}
.ic-search{width:18px;height:18px}.ic-search::before{content:'';position:absolute;width:11px;height:11px;border:2px solid currentColor;border-radius:50%;top:1px;left:1px;}.ic-search::after{content:'';position:absolute;width:5px;height:2px;background:currentColor;transform:rotate(45deg);bottom:2px;right:1px;}
.ic-user{width:22px;height:22px}.ic-user::before{content:'';position:absolute;width:9px;height:9px;background:currentColor;border-radius:50%;top:2px;left:50%;transform:translateX(-50%);}.ic-user::after{content:'';position:absolute;width:16px;height:8px;background:currentColor;border-radius:8px 8px 0 0;bottom:1px;left:50%;transform:translateX(-50%);}
.ic-back{width:22px;height:22px}.ic-back::before{content:'';position:absolute;width:10px;height:10px;border-left:2.5px solid currentColor;border-bottom:2.5px solid currentColor;transform:rotate(45deg);top:50%;left:6px;margin-top:-5px;}.ic-back::after{content:'';position:absolute;width:14px;height:2.5px;background:currentColor;border-radius:2px;top:50%;left:4px;margin-top:-1.25px;}
.ic-link{width:18px;height:18px}.ic-link::before{content:'';position:absolute;width:8px;height:8px;border:2px solid currentColor;border-radius:50%;top:1px;left:1px;}.ic-link::after{content:'';position:absolute;width:8px;height:8px;border:2px solid currentColor;border-radius:50%;bottom:1px;right:1px;}
.ic-exit{width:18px;height:18px}.ic-exit::before{content:'';position:absolute;width:10px;height:14px;border:2px solid currentColor;border-radius:2px;left:1px;top:2px;}.ic-exit::after{content:'';position:absolute;width:7px;height:2px;background:currentColor;right:1px;top:50%;margin-top:-1px;box-shadow:3px -3px 0 currentColor,3px 3px 0 currentColor;}
.ic-send{width:20px;height:20px}.ic-send::before{content:'';position:absolute;width:0;height:0;border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:14px solid currentColor;top:50%;left:4px;margin-top:-7px;}
.ic-smile{width:20px;height:20px}.ic-smile::before{content:'';position:absolute;width:16px;height:16px;border:2px solid currentColor;border-radius:50%;top:2px;left:2px;}.ic-smile::after{content:'';position:absolute;width:8px;height:4px;border-bottom:2px solid currentColor;border-radius:0 0 6px 6px;top:9px;left:6px;box-shadow:-3px -4px 0 0 currentColor,3px -4px 0 0 currentColor;}
.ic-image{width:20px;height:20px}.ic-image::before{content:'';position:absolute;width:16px;height:13px;border:2px solid currentColor;border-radius:3px;top:3px;left:2px;}.ic-image::after{content:'';position:absolute;width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:5px solid currentColor;bottom:5px;left:4px;box-shadow:6px -2px 0 -2px currentColor;}
.ic-eye{width:18px;height:18px}.ic-eye::before{content:'';position:absolute;width:14px;height:8px;border:2px solid currentColor;border-radius:50%;top:5px;left:2px;}.ic-eye::after{content:'';position:absolute;width:5px;height:5px;background:currentColor;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);}
.ic-tag{width:18px;height:18px}.ic-tag::before{content:'';position:absolute;width:12px;height:14px;background:currentColor;clip-path:polygon(0 0,100% 0,100% 80%,50% 100%,0 80%);top:2px;left:3px;}
.ic-trash{width:18px;height:18px}.ic-trash::before{content:'';position:absolute;width:12px;height:10px;border:2px solid currentColor;border-top:none;border-radius:0 0 3px 3px;bottom:1px;left:3px;}.ic-trash::after{content:'';position:absolute;width:14px;height:2px;background:currentColor;border-radius:1px;top:4px;left:2px;box-shadow:4px -4px 0 -1px currentColor;}
.ic-lock{width:18px;height:18px}.ic-lock::before{content:'';position:absolute;width:10px;height:8px;border:2px solid currentColor;border-radius:2px;bottom:1px;left:4px;}.ic-lock::after{content:'';position:absolute;width:6px;height:6px;border:2px solid currentColor;border-bottom:none;border-radius:4px 4px 0 0;top:2px;left:6px;}
.ic-home{width:22px;height:22px}.ic-home::before{content:'';position:absolute;width:14px;height:10px;border-left:2px solid currentColor;border-right:2px solid currentColor;border-bottom:2px solid currentColor;border-radius:0 0 3px 3px;bottom:2px;left:4px;}.ic-home::after{content:'';position:absolute;width:0;height:0;border-left:9px solid transparent;border-right:9px solid transparent;border-bottom:9px solid currentColor;top:3px;left:2px;}
.ic-rocket{width:22px;height:22px}.ic-rocket::before{content:'';position:absolute;width:10px;height:14px;background:currentColor;clip-path:polygon(50% 0%,100% 70%,50% 100%,0% 70%);top:1px;left:6px;}.ic-rocket::after{content:'';position:absolute;width:6px;height:4px;background:currentColor;clip-path:polygon(0 0,100% 0,80% 100%,20% 100%);bottom:2px;left:8px;opacity:.7;}
.ic-copy{width:18px;height:18px}.ic-copy::before{content:'';position:absolute;width:10px;height:12px;border:2px solid currentColor;border-radius:2px;bottom:1px;right:1px;}.ic-copy::after{content:'';position:absolute;width:10px;height:12px;border:2px solid currentColor;border-radius:2px;background:var(--bg3);top:1px;left:1px;}
.ic-check{width:18px;height:18px}.ic-check::before{content:'';position:absolute;width:10px;height:6px;border-left:2.5px solid currentColor;border-bottom:2.5px solid currentColor;transform:rotate(-45deg);top:5px;left:4px;}
.ic-spin{width:20px;height:20px}.ic-spin::before{content:'';position:absolute;width:16px;height:16px;border:2px solid var(--b2);border-top-color:var(--violet);border-radius:50%;animation:spin .7s linear infinite;top:2px;left:2px;}
@keyframes spin{to{transform:rotate(360deg)}}

/* ═══════════════════════════════════════
   MAIN SCREEN
═══════════════════════════════════════ */
#main-screen { background: var(--bg); }
.app-header {
  background: rgba(5,6,15,.72); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
  display: flex; align-items: center; padding: 14px 18px;
  padding-top: max(14px,env(safe-area-inset-top));
  gap: 14px; border-bottom: 1px solid var(--b1); flex-shrink: 0; z-index: 5; position: relative;
}
.app-header::after {
  content:''; position:absolute; bottom:0; left:0; right:0; height:1px;
  background: linear-gradient(90deg, transparent, rgba(167,139,250,.3), rgba(244,114,182,.2), transparent);
}
.app-header h2 {
  font-size: 22px; font-weight: 800; flex: 1; letter-spacing: -1px;
  background: linear-gradient(90deg, #f0f4ff, #c4b5fd 50%, #f9a8d4);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.header-btn {
  width: 40px; height: 40px; background: var(--s1); border: 1px solid var(--b1);
  border-radius: 13px; color: var(--t2); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all .25s cubic-bezier(.34,1.2,.64,1); position: relative; overflow: hidden;
}
.header-btn:hover { border-color: var(--b2); transform: scale(1.08); color: var(--violet); background: rgba(139,92,246,.1); }
.header-btn:active { transform: scale(.93); }
.avatar {
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-weight: 800; color: #fff; flex-shrink: 0; font-family: var(--font);
  text-transform: uppercase; position: relative;
}
.search-bar { padding: 12px 18px; flex-shrink: 0; }
.search-input-wrap { position: relative; }
.search-input {
  width: 100%; background: var(--s1); border: 1px solid var(--b1);
  border-radius: 16px; padding: 12px 18px 12px 46px;
  color: var(--t1); font-size: 14px; outline: none; transition: all .3s ease; backdrop-filter: blur(16px);
}
.search-input:focus { border-color: rgba(167,139,250,.4); background: var(--s2); box-shadow: 0 0 0 3px rgba(167,139,250,.1); }
.search-input::placeholder { color: var(--t3); }
.search-ic-wrap { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--t3); transition: color .2s; }
.search-input:focus ~ .search-ic-wrap { color: var(--violet); }

.chats-list { flex: 1; overflow-y: auto; overscroll-behavior: contain; }
.chats-list::-webkit-scrollbar { width: 2px; }
.chats-list::-webkit-scrollbar-thumb { background: linear-gradient(to bottom, var(--violet), var(--rose)); border-radius: 2px; }

.chat-item {
  display: flex; align-items: center; gap: 14px; padding: 13px 18px;
  cursor: pointer; transition: background .2s ease, transform .15s;
  position: relative; animation: chatItemSlide .35s cubic-bezier(.34,1.2,.64,1) both;
}
@keyframes chatItemSlide { from { opacity:0; transform:translateX(-16px) scale(.97); } to { opacity:1; transform:none; } }
.chat-item::after { content:''; position:absolute; bottom:0; left:78px; right:18px; height:1px; background: linear-gradient(90deg, var(--b1), transparent); }
.chat-item:hover { background: rgba(167,139,250,.04); }
.chat-item:active { transform: scale(.99); }
.chat-item-info { flex: 1; min-width: 0; }
.chat-item-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:4px; }
.chat-item-name { font-size: 15px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.chat-item-time { font-size: 11px; color: var(--t3); flex-shrink: 0; }
.chat-item-preview { font-size: 13px; color: var(--t2); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.chat-item-badge {
  background: linear-gradient(135deg, var(--violet), var(--rose)); color: #fff;
  border-radius: 12px; font-size: 10px; font-weight: 700; padding: 3px 8px; flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(167,139,250,.4); animation: badgePop .3s cubic-bezier(.34,1.4,.64,1);
}
@keyframes badgePop { from{ transform:scale(0); } to{ transform:scale(1); } }

.empty-state { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; }
.empty-illo { width:80px;height:80px;margin:0 auto 24px;position:relative;opacity:.25;animation:emptyFloat 4s ease-in-out infinite; }
@keyframes emptyFloat { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-8px);} }
.empty-illo::before { content:'';position:absolute;width:64px;height:50px;background:linear-gradient(135deg,var(--t3),var(--t4));border-radius:12px 12px 12px 4px;top:0;left:8px; }
.empty-illo::after { content:'';position:absolute;width:0;height:0;border-top:14px solid var(--t3);border-right:14px solid transparent;bottom:8px;left:8px; }
.empty-state h3 { font-size:18px;font-weight:700;margin-bottom:10px;color:var(--t2); }
.empty-state p { font-size:14px;line-height:1.8;color:var(--t3); }

.bottom-nav {
  background: rgba(5,6,15,.78); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
  border-top: 1px solid var(--b1); display: flex;
  padding-bottom: max(12px, env(safe-area-inset-bottom));
  flex-shrink: 0; z-index: 5; position: relative;
}
.bottom-nav::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent,rgba(167,139,250,.25),rgba(56,189,248,.2),transparent); }
.nav-item {
  flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 12px 8px 8px; cursor: pointer; color: var(--t3); font-size: 10px; font-weight: 600;
  gap: 5px; transition: all .3s ease; letter-spacing: .5px; text-transform: uppercase; position: relative;
}
.nav-item::after { content:''; position:absolute; bottom:4px; width:0; height:2px; background:linear-gradient(90deg,var(--violet),var(--rose)); border-radius:2px; transition:width .3s cubic-bezier(.34,1.2,.64,1); }
.nav-item.active { color: var(--violet); }
.nav-item.active::after { width: 20px; }
.nav-item .ic { transition: transform .3s cubic-bezier(.34,1.5,.64,1); }
.nav-item.active .ic { transform: scale(1.18) translateY(-1px); }
.nav-item:active .ic { transform: scale(.9); }

/* ═══════════════════════════════════════
   MODAL
═══════════════════════════════════════ */
.modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,.72);
  backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
  z-index: 200; display: flex; align-items: flex-end;
  opacity: 0; pointer-events: none; transition: opacity .35s;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }
.modal-sheet {
  background: linear-gradient(160deg, rgba(14,16,34,.97), rgba(8,10,22,.98));
  border: 1px solid var(--b2); border-bottom: none;
  border-radius: 28px 28px 0 0; padding: 24px 24px 32px;
  width: 100%; max-height: 92vh; overflow-y: auto;
  transform: translateY(110%); transition: transform .45s cubic-bezier(.34,1.1,.64,1);
  box-shadow: 0 -24px 80px rgba(139,92,246,.25); position: relative;
}
.modal-sheet::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent,rgba(167,139,250,.4),rgba(244,114,182,.3),transparent); border-radius:28px 28px 0 0; }
.modal-overlay.open .modal-sheet { transform: translateY(0); }
.modal-handle { width:40px;height:4px;background:linear-gradient(90deg,var(--violet),var(--rose));border-radius:2px;margin:0 auto 24px;opacity:.5; }
.modal-title { font-size:22px;font-weight:800;margin-bottom:22px;text-align:center;background:linear-gradient(90deg,#f0f4ff,#c4b5fd 50%,#f9a8d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text; }

.room-option {
  background: var(--s1); border: 1px solid var(--b1); border-radius: 20px;
  padding: 18px; margin-bottom: 10px; cursor: pointer;
  transition: all .3s cubic-bezier(.34,1.2,.64,1);
  display: flex; align-items: center; gap: 18px; position: relative; overflow: hidden;
}
.room-option:hover { border-color: var(--b2); transform: translateX(3px); background: rgba(167,139,250,.06); }
.room-option:active { transform: scale(.98); }
.room-option-icon-wrap {
  width: 52px; height: 52px;
  background: linear-gradient(135deg, rgba(139,92,246,.2), rgba(99,102,241,.15));
  border: 1px solid rgba(139,92,246,.2); border-radius: 16px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; color: var(--violet); transition: all .3s;
}
.room-option:hover .room-option-icon-wrap { color: var(--rose); border-color: rgba(244,114,182,.3); }
.room-option-info h3 { font-size: 15px; font-weight: 700; }
.room-option-info p { font-size: 13px; color: var(--t2); margin-top: 3px; }

.code-display {
  background: rgba(139,92,246,.07); border: 1.5px dashed rgba(167,139,250,.35);
  border-radius: 22px; padding: 26px; text-align: center; margin: 18px 0;
  cursor: pointer; transition: all .3s; position: relative; overflow: hidden;
}
.code-display::before { content:''; position:absolute; inset:0; background:radial-gradient(circle at 50% 50%,rgba(167,139,250,.08),transparent 70%); animation:codeGlow 2s ease-in-out infinite alternate; }
@keyframes codeGlow { from{opacity:.5;transform:scale(1);} to{opacity:1;transform:scale(1.05);} }
.code-display:hover { border-color: rgba(244,114,182,.5); transform: scale(1.01); }
.code-display .code-label { font-size:11px;color:var(--t3);margin-bottom:12px;text-transform:uppercase;letter-spacing:1.2px;display:flex;align-items:center;justify-content:center;gap:8px; }
.code-display .code-val { font-size:40px;font-weight:800;letter-spacing:10px;background:linear-gradient(135deg,#c4b5fd,#f9a8d4,#7dd3fc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;background-size:200%;animation:shimmerText 3s linear infinite; }
.code-display .code-hint { font-size:12px;color:var(--t3);margin-top:10px; }

.modal-btn {
  width: 100%; background: linear-gradient(135deg, #7c3aed, #4f46e5, #2563eb);
  border: none; border-radius: 16px; padding: 16px; color: #fff;
  font-size: 15px; font-weight: 700; cursor: pointer; margin-top: 10px;
  transition: all .3s cubic-bezier(.34,1.2,.64,1);
  box-shadow: 0 6px 24px rgba(124,58,237,.4); letter-spacing: .3px;
  position: relative; overflow: hidden;
}
.modal-btn::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent); transition:left .5s; }
.modal-btn:hover::before { left: 100%; }
.modal-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 32px rgba(124,58,237,.5); }
.modal-btn:active { opacity:.85; transform:scale(.98); }
.modal-btn.outline { background:transparent; border:1px solid var(--b2); color:var(--t2); box-shadow:none; }
.modal-btn.outline:hover { background:var(--s1); border-color:var(--b3); color:var(--t1); }
.modal-btn.danger { background:linear-gradient(135deg,#dc2626,#9f1239); box-shadow:0 6px 24px rgba(220,38,38,.3); }
.modal-btn.green  { background:linear-gradient(135deg,#059669,#0891b2); box-shadow:0 6px 24px rgba(5,150,105,.3); }

.connecting-state { text-align:center;padding:28px;color:var(--t2);font-size:14px;display:flex;flex-direction:column;align-items:center; }
.css-spinner {
  width:40px;height:40px;
  border:2.5px solid var(--b1);
  border-top-color:var(--violet);border-right-color:var(--rose);
  border-radius:50%; animation:spin .8s linear infinite; margin-bottom:16px;
  box-shadow:0 0 20px rgba(167,139,250,.2);
}

/* ═══════════════════════════════════════
   CHAT SCREEN
═══════════════════════════════════════ */
#chat-screen { background: var(--bg); }
.chat-header {
  background: rgba(5,6,15,.78); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
  display: flex; align-items: center; padding: 10px 16px;
  padding-top: max(10px,env(safe-area-inset-top));
  gap: 12px; border-bottom: 1px solid var(--b1); flex-shrink: 0; z-index: 5; position: relative;
}
.chat-header::after { content:''; position:absolute; bottom:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent,rgba(167,139,250,.2),transparent); }
.chat-header-back { cursor:pointer;color:var(--violet);display:flex;align-items:center;justify-content:center;padding:8px;border-radius:12px;transition:all .25s cubic-bezier(.34,1.2,.64,1); }
.chat-header-back:hover { background:var(--s2);transform:translateX(-2px) scale(1.05); }
.chat-header-back:active { transform:scale(.9); }
.chat-header-info { flex: 1; min-width: 0; }
.chat-header-name { font-size:16px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis; }
.chat-header-status { font-size:11px;color:var(--violet);font-weight:500;letter-spacing:.3px;margin-top:2px;display:flex;align-items:center;gap:5px; }
.status-dot-live { width:7px;height:7px;background:var(--mint);border-radius:50%;animation:pulseDot 2s ease-in-out infinite;box-shadow:0 0 6px var(--mint); }
@keyframes pulseDot { 0%,100%{box-shadow:0 0 0 0 rgba(52,211,153,.6);} 50%{box-shadow:0 0 0 5px rgba(52,211,153,0);} }
.chat-header-actions { display:flex;gap:6px; }

.chat-bg {
  flex: 1; overflow-y: auto; padding: 16px 14px;
  overscroll-behavior: contain; display: flex; flex-direction: column; gap: 4px;
  background:
    radial-gradient(ellipse 60% 40% at 5% 15%, rgba(139,92,246,.06) 0%, transparent 55%),
    radial-gradient(ellipse 50% 40% at 95% 85%, rgba(56,189,248,.05) 0%, transparent 55%),
    var(--bg);
}
.chat-bg::-webkit-scrollbar { width:2px; }
.chat-bg::-webkit-scrollbar-thumb { background:linear-gradient(to bottom,var(--violet),var(--rose));border-radius:2px; }

.msg-wrap {
  display: flex; flex-direction: column; max-width: 78%;
  animation: msgPop .28s cubic-bezier(.34,1.4,.64,1) both;
}
@keyframes msgPop { from{opacity:0;transform:translateY(12px) scale(.93);} to{opacity:1;transform:none;} }
.msg-wrap.out { align-self:flex-end; align-items:flex-end; }
.msg-wrap.in  { align-self:flex-start; align-items:flex-start; }
.msg-sender-name { font-size:11px;font-weight:600;color:var(--violet);margin-bottom:5px;padding:0 6px;letter-spacing:.3px; }
.msg-bubble {
  padding: 11px 16px; border-radius: 20px;
  font-size: 14px; line-height: 1.65; word-break: break-word;
  position: relative; overflow: hidden;
}
.msg-wrap.out .msg-bubble {
  background: linear-gradient(135deg, #5b21b6 0%, #4338ca 50%, #1d4ed8 100%);
  border-bottom-right-radius: 5px;
  box-shadow: 0 4px 20px rgba(91,33,182,.35), inset 0 1px 0 rgba(255,255,255,.1);
}
.msg-wrap.out .msg-bubble::before {
  content:''; position:absolute; top:0; left:0; right:0; height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
}
.msg-wrap.in .msg-bubble {
  background: rgba(255,255,255,.055);
  border: 1px solid var(--b1); border-bottom-left-radius: 5px;
  backdrop-filter: blur(8px);
}

.msg-photo { max-width:240px;max-height:300px;border-radius:16px;display:block;object-fit:cover;cursor:pointer;border:1px solid var(--b1);transition:transform .2s cubic-bezier(.34,1.4,.64,1),opacity .2s; }
.msg-photo:hover { transform:scale(1.02); }
.msg-photo:active { transform:scale(.97); }
.msg-wrap.out .msg-photo { border-radius:16px 16px 5px 16px; }
.msg-wrap.in .msg-photo  { border-radius:16px 16px 16px 5px; }

.lightbox { position:fixed;inset:0;background:rgba(0,0,0,.92);backdrop-filter:blur(20px);z-index:500;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s; }
.lightbox.open { opacity:1;pointer-events:all; }
.lightbox img { max-width:95vw;max-height:90vh;border-radius:16px;object-fit:contain;animation:lbReveal .3s cubic-bezier(.34,1.2,.64,1) both; }
@keyframes lbReveal { from{transform:scale(.9);opacity:0;} to{transform:none;opacity:1;} }
.lightbox-close { position:absolute;top:18px;right:18px;width:40px;height:40px;background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#fff;border:1px solid rgba(255,255,255,.15);font-size:22px;line-height:1;transition:all .2s;font-weight:300; }
.lightbox-close:hover { background:rgba(255,255,255,.2);transform:scale(1.1) rotate(90deg); }

.msg-meta { display:flex;align-items:center;gap:5px;margin-top:5px;padding:0 4px; }
.msg-time { font-size:10px;color:var(--t3);letter-spacing:.2px; }
.msg-checks { display:flex;gap:1px;align-items:center; }
.msg-checks span { width:8px;height:5px;border-bottom:2px solid rgba(167,139,250,.6);border-left:2px solid rgba(167,139,250,.6);transform:rotate(-45deg);display:block; }

.typing-bubble { align-self:flex-start;background:rgba(255,255,255,.06);border:1px solid var(--b1);border-radius:20px;border-bottom-left-radius:5px;padding:14px 18px;display:none;gap:6px;align-items:center;margin:0 14px 4px;backdrop-filter:blur(8px); }
.typing-bubble.show { display:flex;animation:msgPop .25s cubic-bezier(.34,1.4,.64,1) both; }
.td { width:7px;height:7px;border-radius:50%;animation:typingBounce 1.3s ease-in-out infinite; }
.td:nth-child(1){background:var(--violet);animation-delay:0s;}
.td:nth-child(2){background:var(--rose);animation-delay:.16s;}
.td:nth-child(3){background:var(--sky);animation-delay:.32s;}
@keyframes typingBounce { 0%,60%,100%{transform:translateY(0) scale(1);}  30%{transform:translateY(-8px) scale(1.2);} }

.sys-msg { text-align:center;margin:12px 0; }
.sys-msg span { background:rgba(255,255,255,.04);color:var(--t3);font-size:11px;padding:6px 16px;border-radius:24px;border:1px solid var(--b1);backdrop-filter:blur(8px);letter-spacing:.3px;display:inline-flex;align-items:center;gap:7px; }

.photo-preview { display:none;padding:10px 14px 0; }
.photo-preview.show { display:flex;gap:10px;align-items:flex-end;animation:msgPop .2s ease both; }
.photo-preview-img { width:64px;height:64px;object-fit:cover;border-radius:12px;border:1px solid var(--b2);box-shadow:0 4px 16px rgba(139,92,246,.3); }
.photo-preview-remove { width:24px;height:24px;background:linear-gradient(135deg,var(--rose),var(--coral));border:none;border-radius:50%;cursor:pointer;color:#fff;font-size:14px;display:flex;align-items:center;justify-content:center;margin-left:-18px;align-self:flex-start;flex-shrink:0;position:relative;top:-8px;transition:transform .2s;line-height:1; }
.photo-preview-remove:hover { transform:scale(1.15) rotate(10deg); }

.upload-progress { display:none;padding:8px 14px;align-items:center;gap:12px;font-size:12px;color:var(--t2); }
.upload-progress.show { display:flex;animation:msgPop .2s ease both; }
.upload-bar-wrap { flex:1;height:3px;background:var(--b1);border-radius:2px;overflow:hidden; }
.upload-bar { height:100%;background:linear-gradient(90deg,var(--violet),var(--rose),var(--sky));background-size:200%;border-radius:2px;width:0%;transition:width .15s;animation:barShimmer 1.5s linear infinite; }
@keyframes barShimmer { to{background-position:-200% 0;} }

.chat-input-area {
  background: rgba(5,6,15,.82); backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);
  border-top:1px solid var(--b1); padding:12px 14px;
  padding-bottom:max(12px,env(safe-area-inset-bottom));
  display:flex;gap:10px;align-items:flex-end;flex-shrink:0;
}
.msg-input-wrap {
  flex:1;background:var(--s1);border:1px solid var(--b1);border-radius:24px;
  display:flex;align-items:flex-end;padding:0 12px;transition:all .3s ease;
}
.msg-input-wrap:focus-within { border-color:rgba(167,139,250,.4);background:var(--s2);box-shadow:0 0 0 3px rgba(167,139,250,.08),0 0 20px rgba(167,139,250,.08); }
#msg-textarea { flex:1;background:transparent;border:none;color:var(--t1);font-size:15px;outline:none;padding:13px 0;resize:none;max-height:120px;line-height:1.45; }
#msg-textarea::placeholder { color:var(--t4); }
.input-action-btn { background:none;border:none;color:var(--t3);padding:8px 5px;cursor:pointer;display:flex;align-items:center;transition:all .25s cubic-bezier(.34,1.4,.64,1); }
.input-action-btn:hover { color:var(--violet);transform:scale(1.15); }
.input-action-btn:active { transform:scale(.85); }

.send-btn {
  width:48px;height:48px;background:linear-gradient(135deg,#7c3aed,#4f46e5);
  border:none;border-radius:16px;color:#fff;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all .3s cubic-bezier(.34,1.3,.64,1);flex-shrink:0;
  box-shadow:0 4px 18px rgba(124,58,237,.45);position:relative;overflow:hidden;
}
.send-btn::after { content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.1),transparent);opacity:0;transition:opacity .2s; }
.send-btn:hover { transform:scale(1.08) rotate(-5deg);box-shadow:0 8px 28px rgba(124,58,237,.55); }
.send-btn:hover::after { opacity:1; }
.send-btn:active { transform:scale(.92); }
.send-btn:disabled { opacity:.3;background:var(--s2);box-shadow:none;transform:none; }
#photo-input { display:none; }

/* ═══════════════════════════════════════
   EMOJI PICKER
═══════════════════════════════════════ */
.emoji-picker {
  position:absolute;bottom:74px;left:0;right:0;
  background:rgba(7,9,20,.97);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
  border-top:1px solid var(--b1);display:none;flex-direction:column;z-index:50;
  max-height:320px;overflow:hidden;box-shadow:0 -20px 60px rgba(0,0,0,.5);
}
.emoji-picker::before { content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(167,139,250,.3),rgba(244,114,182,.25),transparent); }
.emoji-picker.open { display:flex;animation:emojiReveal .25s cubic-bezier(.34,1.2,.64,1) both; }
@keyframes emojiReveal { from{opacity:0;transform:translateY(12px);} to{opacity:1;transform:none;} }

.emoji-cats-tabs { display:flex;gap:2px;padding:10px 10px 8px;border-bottom:1px solid var(--b1);overflow-x:auto;flex-shrink:0;scrollbar-width:none; }
.emoji-cats-tabs::-webkit-scrollbar { display:none; }
.emoji-cat-tab { background:none;border:none;font-size:19px;padding:7px 10px;border-radius:10px;cursor:pointer;flex-shrink:0;transition:all .2s cubic-bezier(.34,1.4,.64,1);filter:grayscale(1) opacity(.45); }
.emoji-cat-tab:hover { filter:grayscale(0) opacity(1);transform:scale(1.22); }
.emoji-cat-tab.active { background:var(--s2);filter:grayscale(0) opacity(1);transform:scale(1.1);box-shadow:0 2px 8px rgba(167,139,250,.2); }

.emoji-search-wrap { padding:8px 10px 6px;flex-shrink:0; }
.emoji-search { width:100%;background:var(--s1);border:1px solid var(--b1);border-radius:12px;padding:8px 14px;color:var(--t1);font-size:13px;outline:none;font-family:var(--font);transition:border-color .2s; }
.emoji-search:focus { border-color:rgba(167,139,250,.4); }
.emoji-search::placeholder { color:var(--t4); }

.emoji-cat-label { font-size:10px;font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:1px;padding:8px 12px 4px;flex-shrink:0; }

.emoji-grid { flex:1;overflow-y:auto;padding:4px 8px 12px;display:flex;flex-wrap:wrap;gap:2px;overscroll-behavior:contain;scrollbar-width:thin;scrollbar-color:var(--violet) transparent; }
.emoji-grid::-webkit-scrollbar { width:2px; }
.emoji-grid::-webkit-scrollbar-thumb { background:linear-gradient(to bottom,var(--violet),var(--rose));border-radius:2px; }

.emoji-btn-pick { background:none;border:none;font-size:24px;cursor:pointer;padding:6px;border-radius:10px;transition:all .15s cubic-bezier(.34,1.5,.64,1);line-height:1; }
.emoji-btn-pick:hover { background:var(--s2);transform:scale(1.3) translateY(-2px); }
.emoji-btn-pick:active { transform:scale(.88); }

/* ═══════════════════════════════════════
   PROFILE SCREEN
═══════════════════════════════════════ */
#profile-screen { background:var(--bg); }
.profile-back-btn { position:absolute;top:max(18px,env(safe-area-inset-top));left:18px;width:42px;height:42px;background:rgba(255,255,255,.1);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.12);border-radius:14px;display:flex;align-items:center;justify-content:center;color:#fff;cursor:pointer;z-index:10;transition:all .25s cubic-bezier(.34,1.2,.64,1); }
.profile-back-btn:hover { background:rgba(255,255,255,.16);transform:scale(1.05) translateX(-2px); }
.profile-back-btn:active { transform:scale(.93); }

.profile-hero { position:relative;overflow:hidden;background:linear-gradient(160deg,#100c2a 0%,#0d1535 50%,#080c18 100%);padding:70px 26px 36px;text-align:center;padding-top:max(70px,calc(env(safe-area-inset-top)+56px)); }
.profile-hero::before { content:'';position:absolute;inset:0;background:radial-gradient(circle 250px at 25% 35%,rgba(139,92,246,.3),transparent),radial-gradient(circle 200px at 75% 70%,rgba(244,114,182,.2),transparent),radial-gradient(circle 180px at 50% 90%,rgba(56,189,248,.15),transparent);animation:heroGlow 6s ease-in-out infinite alternate; }
@keyframes heroGlow { 0%{filter:hue-rotate(0deg);} 100%{filter:hue-rotate(30deg);} }
.profile-hero::after { content:'';position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.015) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.015) 1px,transparent 1px);background-size:30px 30px; }

.profile-avatar-big { position:relative;z-index:1;width:96px;height:96px;border-radius:50%;font-size:36px;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-weight:800;border:2px solid rgba(255,255,255,.1);box-shadow:0 0 0 4px rgba(139,92,246,.25),0 0 0 8px rgba(139,92,246,.1),0 12px 40px rgba(0,0,0,.6);animation:avatarPulse 4s ease-in-out infinite; }
@keyframes avatarPulse { 0%,100%{box-shadow:0 0 0 4px rgba(139,92,246,.25),0 0 0 8px rgba(139,92,246,.1),0 12px 40px rgba(0,0,0,.6);} 50%{box-shadow:0 0 0 4px rgba(244,114,182,.35),0 0 0 10px rgba(244,114,182,.12),0 12px 60px rgba(0,0,0,.7),0 0 60px rgba(167,139,250,.25);} }
.profile-name { position:relative;z-index:1;font-size:24px;font-weight:800;letter-spacing:-.5px; }
.profile-username { position:relative;z-index:1;color:var(--t3);font-size:13px;margin-top:5px;letter-spacing:.5px; }

.profile-body { padding:22px 18px;overflow-y:auto;flex:1; }
.profile-section { background:var(--s1);border:1px solid var(--b1);border-radius:20px;margin-bottom:14px;overflow:hidden; }
.profile-row { display:flex;align-items:center;gap:16px;padding:16px 18px;border-bottom:1px solid var(--b1);cursor:pointer;transition:background .2s;position:relative;overflow:hidden; }
.profile-row:hover { background:rgba(167,139,250,.05); }
.profile-row:last-child { border:none; }
.profile-row:active { background:var(--s2); }
.profile-row-icon { width:36px;height:36px;background:var(--s2);border:1px solid var(--b1);border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--t2);transition:all .25s; }
.profile-row:hover .profile-row-icon { border-color:rgba(167,139,250,.3);color:var(--violet);background:rgba(139,92,246,.1); }
.profile-row-info { flex:1; }
.profile-row-label { font-size:10px;color:var(--t3);margin-bottom:3px;letter-spacing:.8px;text-transform:uppercase;font-weight:600; }
.profile-row-value { font-size:14px;font-weight:600; }

/* ═══════════════════════════════════════
   TOAST
═══════════════════════════════════════ */
.toast { position:fixed;bottom:100px;left:50%;transform:translateX(-50%) translateY(20px) scale(.95);background:rgba(12,15,30,.95);backdrop-filter:blur(20px);color:#fff;padding:12px 24px;border-radius:24px;font-size:13px;font-weight:500;z-index:999;opacity:0;transition:all .35s cubic-bezier(.34,1.4,.64,1);pointer-events:none;white-space:nowrap;border:1px solid var(--b2);box-shadow:0 10px 40px rgba(0,0,0,.6),0 0 0 1px rgba(167,139,250,.1); }
.toast.show { opacity:1;transform:translateX(-50%) translateY(0) scale(1); }
